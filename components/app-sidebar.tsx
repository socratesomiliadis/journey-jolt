"use client";

import * as React from "react";
import {
  Airplay,
  AudioWaveform,
  BookOpen,
  Bot,
  Command,
  Frame,
  GalleryVerticalEnd,
  Loader2,
  Map,
  PieChart,
  Settings2,
  SquareTerminal,
  TicketsPlane,
  Users,
} from "lucide-react";

import { NavMain } from "@/components/nav-main";
import { NavProjects } from "@/components/nav-projects";
import { NavUser } from "@/components/nav-user";
import {
  Sidebar,
  SidebarContent,
  SidebarFooter,
  SidebarHeader,
  SidebarRail,
} from "@/components/ui/sidebar";
import { authClient } from "@/lib/auth-client";
import { History } from "./Chat/history";

const data = {
  navMain: [
    {
      title: "Trips",
      url: "/dashboard",
      icon: TicketsPlane,
      isActive: true,
      items: [
        {
          title: "Upcoming Trips",
          url: "/dashboard/trips",
        },
        {
          title: "Past Trips",
          url: "/dashboard/trips/past",
        },
      ],
    },
    {
      title: "Passengers",
      url: "#",
      icon: Users,
      items: [
        {
          title: "Manage Passengers",
          url: "/dashboard/passengers",
        },
      ],
    },
    {
      title: "Settings",
      url: "#",
      icon: Settings2,
      items: [
        {
          title: "General",
          url: "#",
        },
        {
          title: "Payment Methods",
          url: "#",
        },
      ],
    },
  ],
};

export function AppSidebar({ ...props }: React.ComponentProps<typeof Sidebar>) {
  const { data: session, isPending } = authClient.useSession();

  const user = {
    name: session?.user.name || "",
    email: session?.user.email || "",
    avatar: session?.user.image || "",
  };

  console.log(session);

  if (isPending) {
    return (
      <Sidebar collapsible="icon" {...props}>
        <span className="h-full w-full flex flex-row items-center justify-center group-data-[collapsible=icon]:gap-4 transition-all duration-300 ease-out text-black dark:text-white">
          <Loader2 className="animate-spin" />
        </span>
      </Sidebar>
    );
  }

  return (
    <Sidebar collapsible="icon" {...props}>
      <SidebarHeader className="border-b-[0px] overflow-hidden border-black/[0.1] dark:border-white/[0.1] transition-all duration-300 ease-out p-4 mt-2 group-data-[collapsible=icon]:p-[calc(1rem-2.5px)] ">
        <span
          data-sidebar="group"
          className="flex flex-row items-center gap-3 w-40 group-data-[collapsible=icon]:gap-4 group-data-[collapsible=icon]:w-36 transition-all duration-300 ease-out text-black dark:text-white"
        >
          <svg
            width="16%"
            viewBox="0 0 266 351"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M120.944 112.159C120.944 107.836 116.511 104.932 112.548 106.658L3.94404 153.975C1.80874 154.906 0.405694 156.982 0.356891 159.31C0.13689 169.807 -0.365761 200.497 0.444458 232.5C1.44449 272 46.0445 351.2 132.444 350C218.844 348.8 265.944 271 265.944 234.5V6.09924C265.944 1.79174 261.54 -1.11244 257.581 0.584369L150.581 46.4415C148.375 47.387 146.944 49.5562 146.944 51.9564V185.344C146.944 193 154.903 199.366 160.345 204.1C170 212.5 181.496 219.718 199.739 226.352C201.063 226.833 201.944 228.091 201.944 229.5C201.944 230.909 201.063 232.167 199.739 232.648C181.496 239.282 169.468 245.776 160.345 254.9C151.221 264.024 144.727 276.052 138.093 294.295C137.611 295.619 136.353 296.5 134.944 296.5C133.536 296.5 132.278 295.619 131.796 294.295C125.162 276.052 118.668 264.024 109.544 254.9C100.421 245.776 88.3927 239.282 70.1496 232.648C68.8257 232.167 67.9445 230.909 67.9445 229.5C67.9445 228.091 68.8257 226.833 70.1496 226.352C88.3927 219.718 100.376 213.224 109.5 204.1C113.784 199.816 120.944 189.361 120.944 185.344V112.159Z"
              fill="#1E92FF"
            />
          </svg>
          <svg
            width="84%"
            className="-mb-1"
            viewBox="0 0 1251 243"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M0.678634 188V156.979H11.3499C19.2914 156.979 25.5784 154.745 30.2109 150.278C35.0088 145.646 37.4078 139.524 37.4078 131.914V3.11327H71.4071V130.673C71.4071 142.089 68.9254 152.098 63.962 160.701C59.1641 169.305 52.2153 176.005 43.1157 180.803C34.1816 185.601 23.593 188 11.3499 188H0.678634ZM157.169 190.978C143.934 190.978 131.856 187.917 120.936 181.796C110.182 175.674 101.579 167.319 95.1267 156.731C88.8398 146.142 85.6963 134.064 85.6963 120.498C85.6963 106.931 88.8398 94.8535 95.1267 84.2649C101.579 73.6763 110.182 65.3212 120.936 59.1997C131.69 53.0782 143.768 50.0174 157.169 50.0174C170.405 50.0174 182.4 53.0782 193.154 59.1997C203.908 65.3212 212.428 73.6763 218.715 84.2649C225.168 94.688 228.394 106.766 228.394 120.498C228.394 134.064 225.168 146.142 218.715 156.731C212.263 167.319 203.66 175.674 192.906 181.796C182.152 187.917 170.24 190.978 157.169 190.978ZM157.169 161.198C164.449 161.198 170.819 159.46 176.278 155.986C181.904 152.512 186.288 147.714 189.431 141.592C192.74 135.305 194.395 128.274 194.395 120.498C194.395 112.556 192.74 105.608 189.431 99.6514C186.288 93.5299 181.904 88.732 176.278 85.2576C170.819 81.6177 164.449 79.7978 157.169 79.7978C149.724 79.7978 143.189 81.6177 137.564 85.2576C131.939 88.732 127.472 93.5299 124.163 99.6514C121.019 105.608 119.447 112.556 119.447 120.498C119.447 128.274 121.019 135.305 124.163 141.592C127.472 147.714 131.939 152.512 137.564 155.986C143.189 159.46 149.724 161.198 157.169 161.198ZM288.785 190.978C278.362 190.978 269.262 188.662 261.486 184.029C253.875 179.397 248.002 172.944 243.866 164.672C239.895 156.4 237.91 146.721 237.91 135.636V52.9955H270.42V132.906C270.42 138.531 271.496 143.495 273.646 147.796C275.963 151.933 279.189 155.242 283.325 157.723C287.627 160.04 292.425 161.198 297.719 161.198C303.013 161.198 307.728 160.04 311.865 157.723C316.001 155.242 319.227 151.85 321.543 147.548C323.859 143.247 325.018 138.118 325.018 132.162V52.9955H357.528V188H326.755V161.446L329.485 166.161C326.341 174.433 321.13 180.638 313.85 184.774C306.736 188.91 298.381 190.978 288.785 190.978ZM380.303 188V52.9955H410.828V83.0241L408.346 78.557C411.49 68.4647 416.371 61.4332 422.989 57.4625C429.772 53.4918 437.879 51.5064 447.309 51.5064H455.251V80.2942H443.587C434.322 80.2942 426.877 83.1895 421.251 88.9801C415.626 94.6053 412.814 102.547 412.814 112.804V188H380.303ZM465.68 188V52.9955H496.204V79.5497L493.723 74.8344C496.866 66.7275 501.995 60.606 509.109 56.4698C516.389 52.1682 524.827 50.0174 534.423 50.0174C544.35 50.0174 553.118 52.1682 560.729 56.4698C568.505 60.7715 574.544 66.8103 578.845 74.5863C583.147 82.1968 585.298 91.0482 585.298 101.14V188H552.787V108.834C552.787 102.878 551.629 97.7488 549.313 93.4472C546.997 89.1456 543.77 85.8366 539.634 83.5204C535.664 81.0387 530.948 79.7978 525.489 79.7978C520.194 79.7978 515.479 81.0387 511.343 83.5204C507.207 85.8366 503.98 89.1456 501.664 93.4472C499.348 97.7488 498.19 102.878 498.19 108.834V188H465.68ZM669.371 190.978C655.474 190.978 643.313 187.835 632.89 181.548C622.467 175.261 614.36 166.74 608.569 155.986C602.779 145.232 599.883 133.32 599.883 120.25C599.883 106.683 602.779 94.688 608.569 84.2649C614.525 73.6763 622.55 65.3212 632.642 59.1997C642.9 53.0782 654.315 50.0174 666.889 50.0174C677.478 50.0174 686.743 51.7546 694.684 55.229C702.791 58.7034 709.657 63.5013 715.283 69.6229C720.908 75.7444 725.209 82.7759 728.187 90.7173C731.165 98.4933 732.654 106.931 732.654 116.031C732.654 118.347 732.489 120.746 732.158 123.228C731.993 125.709 731.579 127.86 730.917 129.68H626.686V104.863H712.553L697.166 116.527C698.655 108.916 698.241 102.133 695.925 96.1771C693.774 90.221 690.135 85.5057 685.006 82.0314C680.042 78.557 674.004 76.8198 666.889 76.8198C660.106 76.8198 654.067 78.557 648.773 82.0314C643.479 85.3403 639.425 90.3037 636.613 96.9216C633.965 103.374 632.973 111.233 633.635 120.498C632.973 128.77 634.048 136.132 636.861 142.585C639.839 148.872 644.14 153.753 649.766 157.227C655.556 160.701 662.174 162.438 669.619 162.438C677.064 162.438 683.351 160.867 688.48 157.723C693.774 154.58 697.911 150.361 700.889 145.067L727.195 157.971C724.548 164.424 720.411 170.132 714.786 175.095C709.161 180.059 702.46 183.947 694.684 186.759C687.074 189.572 678.636 190.978 669.371 190.978ZM766.233 242.846C762.593 242.846 759.036 242.515 755.562 241.853C752.087 241.357 748.944 240.447 746.131 239.123V211.824C748.282 212.321 750.846 212.817 753.824 213.313C756.968 213.81 759.863 214.058 762.51 214.058C769.955 214.058 775.333 212.321 778.641 208.846C782.116 205.372 785.177 200.822 787.824 195.197L796.758 174.351L796.262 201.649L737.445 52.9955H772.437L813.633 162.687H801.225L842.173 52.9955H877.413L818.597 201.649C815.122 210.418 810.904 217.863 805.94 223.985C800.977 230.106 795.186 234.739 788.568 237.882C782.116 241.191 774.671 242.846 766.233 242.846ZM877.398 188V156.979H888.069C896.01 156.979 902.297 154.745 906.93 150.278C911.728 145.646 914.127 139.524 914.127 131.914V3.11327H948.126V130.673C948.126 142.089 945.644 152.098 940.681 160.701C935.883 169.305 928.934 176.005 919.835 180.803C910.901 185.601 900.312 188 888.069 188H877.398ZM1033.89 190.978C1020.65 190.978 1008.57 187.917 997.655 181.796C986.901 175.674 978.298 167.319 971.846 156.731C965.559 146.142 962.415 134.064 962.415 120.498C962.415 106.931 965.559 94.8535 971.846 84.2649C978.298 73.6763 986.901 65.3212 997.655 59.1997C1008.41 53.0782 1020.49 50.0174 1033.89 50.0174C1047.12 50.0174 1059.12 53.0782 1069.87 59.1997C1080.63 65.3212 1089.15 73.6763 1095.43 84.2649C1101.89 94.688 1105.11 106.766 1105.11 120.498C1105.11 134.064 1101.89 146.142 1095.43 156.731C1088.98 167.319 1080.38 175.674 1069.62 181.796C1058.87 187.917 1046.96 190.978 1033.89 190.978ZM1033.89 161.198C1041.17 161.198 1047.54 159.46 1053 155.986C1058.62 152.512 1063.01 147.714 1066.15 141.592C1069.46 135.305 1071.11 128.274 1071.11 120.498C1071.11 112.556 1069.46 105.608 1066.15 99.6514C1063.01 93.5299 1058.62 88.732 1053 85.2576C1047.54 81.6177 1041.17 79.7978 1033.89 79.7978C1026.44 79.7978 1019.91 81.6177 1014.28 85.2576C1008.66 88.732 1004.19 93.5299 1000.88 99.6514C997.738 105.608 996.166 112.556 996.166 120.498C996.166 128.274 997.738 135.305 1000.88 141.592C1004.19 147.714 1008.66 152.512 1014.28 155.986C1019.91 159.46 1026.44 161.198 1033.89 161.198ZM1117.36 188V0.135235H1149.87V188H1117.36ZM1233.99 189.489C1218.77 189.489 1206.94 185.353 1198.5 177.081C1190.23 168.643 1186.09 156.813 1186.09 141.592V82.0314H1162.76V52.9955H1165.24C1171.86 52.9955 1176.99 51.2583 1180.63 47.7839C1184.27 44.3095 1186.09 39.2634 1186.09 32.6455V22.2224H1218.6V52.9955H1249.62V82.0314H1218.6V139.855C1218.6 144.322 1219.35 148.127 1220.83 151.271C1222.49 154.414 1224.97 156.813 1228.28 158.468C1231.75 160.122 1236.14 160.949 1241.43 160.949C1242.59 160.949 1243.91 160.867 1245.4 160.701C1247.06 160.536 1248.63 160.37 1250.12 160.205V188C1247.8 188.331 1245.15 188.662 1242.18 188.993C1239.2 189.324 1236.47 189.489 1233.99 189.489Z"
              fill="currentColor"
            />
          </svg>
        </span>
      </SidebarHeader>
      <SidebarContent>
        <NavMain items={data.navMain} />
        <History user={session?.user} />
      </SidebarContent>
      <SidebarFooter className="pb-3.5">
        <NavUser user={user} />
      </SidebarFooter>
      {/* <SidebarRail /> */}
    </Sidebar>
  );
}
